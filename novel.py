#!/usr/bin/env python2.7
# -*- coding:utf-8 -*-



import urllib2
import bs4
import chardet


def main():
    pidRange = [17796, 17797, 17798, 17799, 17800, 17801, 17802, 17803, 17804, 17806, 17807, 17808, 17809, 17810, 17811, 17812, 17813, 17814, 17815, 17816, 17817, 17818, 17819, 17820, 17821, 17822, 17823, 17825, 17826, 17827, 17828, 17829, 17830, 17831, 17832, 17833, 17834, 17835, 17836, 17837, 17838, 17839, 17840, 17841, 17842, 17843, 17845, 17846, 17847, 17848, 17849, 17850, 17851, 17852, 17853, 17854, 17855, 17856, 17857, 17858, 17859, 17860, 17861, 17862, 17863, 17865, 17866, 17867, 17868, 17869, 17870, 17871, 17872, 17873, 17874, 17875, 17876, 17877, 255878, 255879, 255880, 255881, 255882, 255883, 255885, 255886, 255887, 255888, 255889, 255890, 255891, 255892, 255893, 255894, 255895, 255896, 255897, 255898, 255899, 255900, 255901, 255902, 255903, 255904, 255905, 255906, 255907, 255908, 255909, 255910, 255911, 255912, 255913, 255914, 255915, 255916, 255917, 255918, 255919, 255920, 255921, 255922, 255923, 255924, 255925, 255926, 255927, 255928, 255929, 255930, 255931, 255932, 255933, 255934, 255935, 255936, 255937, 255938, 255939, 255940, 255941, 255942, 255943, 255944, 255945, 255946, 255947, 255948, 255949, 255950, 255951, 255952, 255953, 255954, 255955, 255956, 255957, 255958, 255959, 255960, 255962, 255963, 255964, 255965, 255966, 255967, 255968, 255969, 255970, 255971, 255972, 255973, 255974, 255975, 255976, 255977, 255978, 255979, 255980, 255981, 255982, 255983, 255984, 255985, 255986, 255987, 255988, 255989, 255990, 255991, 255992, 255993, 255994, 255995, 255996, 255997, 255998, 255999, 256001, 256002, 256003, 256004, 256005, 256006, 256007, 256008, 256009, 256010, 256011, 256012, 256013, 256014, 256015, 256016, 256017, 256018, 256019, 256020, 256021, 256022, 256023, 256024, 256025, 256026, 256027, 256028, 256029, 256030, 256031, 256032, 256033, 256034, 256035, 256036, 256037, 256038, 256039, 256040, 256041, 256042, 256043, 256044, 256045, 256046, 256047, 256048, 256049, 256050, 256051, 256052, 256053, 256054, 256056, 256057, 256058, 256059, 256060, 256061, 256062, 256063, 256064, 256065, 256066, 256067, 256068, 256069, 256070, 256071, 256072, 256073, 256074, 256075, 256076, 256077, 256078, 256079, 256080, 256081, 256082, 256083, 256084, 256085, 256086, 256087, 256088, 256089, 256090, 256091, 256092, 256093, 256094, 256095, 256096, 256097, 256098, 256099, 256100, 256101, 256102, 256103, 256104, 256105, 256106, 256107, 256108, 256110, 256111, 256112, 256113, 256114, 256115, 256116, 256117, 256118, 256119, 256120, 256121, 256122, 256123, 256124, 256125, 256126, 256127, 256128, 256129, 256130, 256131, 256132, 256133, 256134, 256135, 256136, 256137, 256138, 256139, 256140, 256141, 256142, 256143, 256144, 256145, 256146, 256147, 256148, 256149, 256150, 256151, 256152, 256153, 256154, 256155, 256156, 256157, 256158, 256159, 256160, 256161, 256162, 256163, 256164, 256165, 256166, 256167, 256168, 256169, 256170, 256172, 256173, 256174, 256175, 256176, 256177, 256178, 256179, 256180, 256181, 256182, 256183, 256184, 256185, 256186, 256187, 256188, 256189, 256190, 256191, 256192, 256193, 256194, 256195, 256196, 256197, 256198, 256199, 256200, 256201, 256202, 256203, 256204, 256205, 256206, 256207, 256208, 256209, 256210, 256211, 256212, 256213, 256214, 256215, 256216, 256217, 256218, 256219, 256220, 256221, 256222, 256223, 256224, 256225, 256226, 256227, 256228, 256229, 256230, 256231, 256232, 256233, 256234, 256235, 256236, 256237, 256238, 256239, 256240, 256241, 256242, 256243, 256244, 256245, 256246, 256248, 256249, 256250, 256251, 256252, 256253, 256254, 256255, 256256, 256257, 256258, 256259, 256260, 256261, 256262, 256263, 256264, 256265, 256266, 256267, 256268, 256269, 256270, 256271, 256272, 256273, 256274, 256275, 256276, 256277, 256278, 256279, 256280, 256281, 256282, 256283, 256284, 256285, 256286, 256287, 256288, 256289, 256290, 256291, 256292, 256293, 256294, 256295, 256296, 256297, 256298, 256299, 256300, 256301, 256303, 256304, 256305, 256306, 256307, 256308, 256309, 256310, 256311, 256312, 256313, 256314, 256315, 256316, 256317, 256318, 256319, 256320, 256321, 256322, 256323, 256324, 256325, 256326, 256327, 256328, 256329, 256330, 256331, 256332, 256333, 256334, 256335, 256336, 256337, 256338, 256339, 256340, 256341, 256342, 256343, 256344, 256345, 256346, 256347, 256348, 256349, 256350, 256351, 256352, 256353, 256354, 256355, 256356, 256357, 256358, 256359, 256360, 256362, 256363, 256364, 256365, 256366, 256367, 256368, 256369, 256370, 256371, 256372, 256373, 256374, 256375, 256376, 256377, 256378, 256379, 256380, 256381, 256382, 256383, 256385, 256386, 256387, 256388, 256389, 256390, 256391, 256392, 256393, 256394, 256395, 256396, 256397, 256398, 256401, 256402, 256403, 256404, 256405, 256406, 256407, 256408, 256409, 256410, 256411, 256412, 256413, 256414, 256415, 256416, 256418, 256419, 256420, 256421, 256422, 256423, 256424, 256425, 256426, 256427, 256428, 256429, 256430, 256431, 256432, 256433, 256434, 256435, 256436, 256437, 256438, 256439, 256440, 256441, 256442, 256443, 256444, 256445, 256446, 256447, 256448]

    pageList = ['http://www.piaotian.net/html/0/122/%d.html' % (pid) for pid in pidRange]
    fout = open('xingchenbian.txt', 'w')
    for pageURL in pageList:
        print pageURL
        pageHTML = urllib2.urlopen(pageURL).read().decode('GBK')
        pageSoup = bs4.BeautifulSoup(pageHTML, 'lxml')
        pageSoup.find('h1').a.extract()
        print >>fout, pageSoup.find('h1').text.strip().encode('utf-8')
        for child in pageSoup.body.children:
            if type(child) == bs4.element.NavigableString and child.strip() != '':
                print >>fout, child.strip('\n').encode('utf-8')

    fout.close()


if __name__ == '__main__':
    main()